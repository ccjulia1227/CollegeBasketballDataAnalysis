cbb_all$POSTSEASON[cbb_all$POSTSEASON == 'Champions'] <- '1'
cbb_all$CONF[cbb_all$CONF == 'ind'] <- 'Ind'
cbb_all <- cbb_all %>%
rename( "two_P_O" = "2P_O",
"two_P_D" = "2P_D",
"three_P_O" = "3P_O",
"three_P_D" = "3P_D")
cbb_all = cbb_all %>%
mutate(W_ratio = W/G) %>%
select('YEAR','TEAM','SEED','POSTSEASON','CONF','G','W','W_ratio','ADJOE','ADJDE','BARTHAG','EFG_O','EFG_D','TOR','TORD','ORB','DRB','FTR','FTRD','two_P_O','two_P_D','three_P_O','three_P_D','ADJ_T','WAB')
cbb_all$POSTSEASON <- as.numeric(cbb_all$POSTSEASON)
cbb_all
cbb_all %>%
filter(CONF == 'ind')
cbb_all %>%
filter(CONF == 'Ind')
cbb_all %>%
filter(CONF == 'GWC')
unique(cbb_all$CONF)
cbb_all %>%
filter(CONF == 'Amer')
# ,fig.height=5,fig.width=5
cbb_all_1 <- cbb_all %>%
count(CONF,SEED) %>%
arrange(CONF,SEED) %>%
filter(SEED != "NA")
p_seed <- ggplot(cbb_all_1, aes(CONF, SEED, fill = n)) +
geom_tile(color = "black") +
geom_text(aes(label=n)) +
scale_fill_continuous(low= "floralwhite", high= "darkblue") +
theme(axis.text.x=element_text(angle=45,vjust=0.5)) +
scale_y_continuous(breaks=seq(1,16,1)) +
xlab("Conference")+ylab("Seed")+ggtitle("Total Number of Teams in Seed 1 to Seed 16 For Every Conference Over 2013-2021") + # 2020的数据除外
coord_fixed() +
coord_flip()
p_seed
# 在tile上增加数字
# 改为深色代表“大”，浅色代表“小”,空白代表NA(而并非将NA filter掉)
# 不能忽略ind组的teams，虽然他们的seed都是NA
box_1 <-ggplot(cbb_all, aes(x=CONF, y=G)) + geom_boxplot() + theme(axis.text.x=element_text(angle=45,vjust=0.5)) + labs(title="Boxplot of G among Conferences",x= "CONF", y = "G")
box_1
box_2 <- ggplot(cbb_all, aes(x=CONF, y=W)) + geom_boxplot() + theme(axis.text.x=element_text(angle=45,vjust=0.5)) + labs(title="Boxplot of W among Conferences",x= "CONF", y = "W")
box_2
box_3 <- ggplot(cbb_all, aes(x=CONF, y=W_ratio)) + geom_boxplot() + theme(axis.text.x=element_text(angle=45,vjust=0.5))+ labs(title="Boxplot of W_ratio among Conferences",x= "CONF", y = "W_ratio")
box_3
box_4 <- ggplot(cbb_all, aes(x=CONF, y=ADJOE)) +
geom_boxplot() +
theme(axis.text.x=element_text(angle=90,vjust=0.5))+
labs(title="Boxplot of ADJOE among Conferences",x= "CONF", y = "ADJOE")
box_4
box_5 <- ggplot(cbb_all, aes(x=CONF, y=ADJDE)) + geom_boxplot() + theme(axis.text.x=element_text(angle=45,vjust=0.5))+ labs(title="Boxplot of ADJDE among Conferences",x= "CONF", y = "ADJDE")
box_5
box_6 <- ggplot(cbb_all, aes(x=CONF, y=BARTHAG)) + geom_boxplot() + theme(axis.text.x=element_text(angle=45,vjust=0.5))+ labs(title="Boxplot of BARTHAG among Conferences",x= "CONF", y = "BARTHAG")
box_6
box_7 <- ggplot(cbb_all, aes(x=CONF, y=EFG_O)) + geom_boxplot() + theme(axis.text.x=element_text(angle=45,vjust=0.5)) + labs(title="Boxplot of EFG_O among Conferences",x= "CONF", y = "EFG_O")
box_7
box_8 <- ggplot(cbb_all, aes(x=CONF, y=EFG_D)) + geom_boxplot() + theme(axis.text.x=element_text(angle=45,vjust=0.5))+ labs(title="Boxplot of EFG_D among Conferences",x= "CONF", y = "EFG_D")
box_8
box_9 <- ggplot(cbb_all, aes(x=CONF, y=TOR)) + geom_boxplot() + theme(axis.text.x=element_text(angle=45,vjust=0.5))+ labs(title="Boxplot of TOR among Conferences",x= "CONF", y = "TOR")
box_9
box_10 <- ggplot(cbb_all, aes(x=CONF, y=TORD)) + geom_boxplot() + theme(axis.text.x=element_text(angle=45,vjust=0.5))+ labs(title="Boxplot of TORD among Conferences",x= "CONF", y = "TORD")
box_10
box_11 <- ggplot(cbb_all, aes(x=CONF, y=ORB)) + geom_boxplot() + theme(axis.text.x=element_text(angle=45,vjust=0.5))+ labs(title="Boxplot of ORB among Conferences",x= "CONF", y = "ORB")
box_11
box_12 <- ggplot(cbb_all, aes(x=CONF, y=DRB)) + geom_boxplot() + theme(axis.text.x=element_text(angle=45,vjust=0.5))+ labs(title="Boxplot of DRB among Conferences",x= "CONF", y = "DRB")
box_12
box_13 <- ggplot(cbb_all, aes(x=CONF, y=FTR)) + geom_boxplot() + theme(axis.text.x=element_text(angle=45,vjust=0.5))+ labs(title="Boxplot of FTR among Conferences",x= "CONF", y = "FTR")
box_13
box_14 <- ggplot(cbb_all, aes(x=CONF, y=FTRD)) + geom_boxplot() + theme(axis.text.x=element_text(angle=45,vjust=0.5))+ labs(title="Boxplot of FTRD among Conferences",x= "CONF", y = "FTRD")
box_14
box_15 <- ggplot(cbb_all, aes(x=CONF, y=two_P_O)) + geom_boxplot() + theme_bw() + theme(axis.text.x=element_text(angle=45,vjust=0.5))+ labs(title="Boxplot of two_P_O among Conferences",x= "CONF", y = "two_P_O")
box_15
box_16 <- ggplot(cbb_all, aes(x=CONF, y=two_P_D)) + geom_boxplot() + theme(axis.text.x=element_text(angle=45,vjust=0.5))+ labs(title="Boxplot of two_P_D among Conferences",x= "CONF", y = "two_P_D")
box_16
box_17 <- ggplot(cbb_all, aes(x=CONF, y=three_P_O)) + geom_boxplot() + theme(axis.text.x=element_text(angle=45,vjust=0.5))+ labs(title="Boxplot of three_P_O among Conferences",x= "CONF", y = "three_P_O")
box_17
box_18 <- ggplot(cbb_all, aes(x=CONF, y=three_P_D)) + geom_boxplot() + theme(axis.text.x=element_text(angle=45,vjust=0.5))+ labs(title="Boxplot of three_P_D among Conferences",x= "CONF", y = "three_P_D")
box_18
box_19 <- ggplot(cbb_all, aes(x=CONF, y=ADJ_T)) + geom_boxplot() + theme(axis.text.x=element_text(angle=45,vjust=0.5))+ labs(title="Boxplot of ADJ_T among Conferences",x= "CONF", y = "ADJ_T")
box_19
box_20 <- ggplot(cbb_all, aes(x=CONF, y=WAB)) + geom_boxplot() + theme(axis.text.x=element_text(angle=45,vjust=0.5))+ labs(title="Boxplot of WAB among Conferences",x= "CONF", y = "WAB")
box_20
library(DT)
cbb_noteam <- subset(cbb_all, select = -c(TEAM,CONF))
cbb_noteam
cbb_corr <- na.omit(cbb_noteam)
# cor(cbb_corr) %>% as.data.frame() %>% datatable()
# 转换成dataframe
# KableExtra - package
# DT - package datatable()
# Hmisc - package rcorr()
# fig.align='center',fig.height=4, fig.width=4
ggcorrplot(cor(cbb_corr[,"SEED"], cbb_corr),lab = TRUE) + coord_flip()
cbb_corr_df <- as.data.frame(cor(cbb_corr[,"SEED"], cbb_corr))
cbb_corr_df <- cbb_corr_df[,-c(2)]
cbb_corr_df_arg <- cbb_corr_df %>%
gather(`YEAR`,`POSTSEASON`,`G`,`W`,`W_ratio`,`ADJOE`,`ADJDE`,`BARTHAG`,`EFG_O`,`EFG_D`,`TOR`,`TORD`,`ORB`,`DRB`,`FTR`,`FTRD`,`two_P_O`,`two_P_D`,`three_P_O`,`three_P_D`,`ADJ_T`,`WAB`, key = "performance", value = "correlation") %>%
arrange(desc(correlation))
ggplot(cbb_corr_df_arg, aes(performance, correlation)) +
geom_point() +
geom_hline(yintercept= 0.3, color = "pink") +
geom_hline(yintercept= -0.3, color = "pink") +
labs(title="Correlation Coefficients of Seed and other Performance Indicators",x= "Performance Indicators", y = "Correlation Coefficients") +
theme_bw() +
theme(axis.text.x=element_text(angle=60,vjust=0.5))
# 增加y轴的范围，0-1
# setting seed to generate a reproducible random sampling
cbb_model = cbb_corr
set.seed(6)
# creating training data as 80% of the dataset
random_sample <- createDataPartition(cbb_model$SEED,
p = 0.8, list = FALSE)
# generating training dataset from the random_sample
training_dataset  <- cbb_model[random_sample, ]
# generating testing dataset from rows which are not included in random_sample
testing_dataset <- cbb_model[-random_sample, ]
# Building the model
model <- lm(SEED ~., data = training_dataset)
# Predicting the target variable
predictions <- predict(model, testing_dataset)
# Computing model performance metrics
data.frame( R2 = R2(predictions, testing_dataset$SEED),
RMSE = RMSE(predictions, testing_dataset$SEED),
MAE = MAE(predictions, testing_dataset$SEED))
# K-fold Cross-Validation
train_control <- trainControl(method = "cv",
number = 10)
model <- train(SEED ~., data = cbb_model,
method = "lm",
trControl = train_control)
print(model)
cbb_train_1 <- subset(training_dataset, select = c(SEED,G,W,W_ratio,ADJOE,ADJDE,BARTHAG,EFG_D,two_P_O,WAB))
cbb_train_2 <- subset(training_dataset, select = -c(YEAR,POSTSEASON))
#define intercept-only model
intercept_only_1 <- lm(SEED ~ 1, data= cbb_train_1)
#define model with all predictors
all_1 <- lm(SEED ~ ., data= cbb_train_1)
#perform backward stepwise regression
model_both_1 <- step(intercept_only_1, direction='both', scope=formula(all_1), trace=1)
#view results of backward stepwise regression
model_both_1$anova
#view final model
model_both_1$coefficients
#define intercept-only model
intercept_only_2 <- lm(SEED ~ 1, data= cbb_train_2)
#define model with all predictors
all_2 <- lm(SEED ~ ., data= cbb_train_2)
#perform backward stepwise regression
model_both_2 <- step(intercept_only_2, direction='both', scope=formula(all_2), trace=1)
#view results of backward stepwise regression
model_both_2$anova
#view final model
model_both_2$coefficients
# Predicting the target variable
predictions_1 <- predict(model_both_1, testing_dataset)
# Computing model performance metrics
data.frame( R2 = R2(predictions_1, testing_dataset$SEED),
RMSE = RMSE(predictions_1, testing_dataset$SEED),
MAE = MAE(predictions_1, testing_dataset$SEED))
# Predicting the target variable
predictions_2 <- predict(model_both_2, testing_dataset)
# Computing model performance metrics
data.frame( R2 = R2(predictions_2, testing_dataset$SEED),
RMSE = RMSE(predictions_2, testing_dataset$SEED),
MAE = MAE(predictions_2, testing_dataset$SEED))
ggplot(testing_dataset, aes(x=predict(model_both_1,newdata = testing_dataset), y= testing_dataset$SEED)) +
geom_point() +
geom_abline(intercept=0, slope=1) +
labs(x='Predicted Values', y='Actual Values', title='Predicted vs. Actual Values')
ggplot(testing_dataset, aes(x=predict(model_both_2,newdata = testing_dataset), y= testing_dataset$SEED)) +
geom_point() +
geom_abline(intercept=0, slope=1) +
labs(x='Predicted Values', y='Actual Values', title='Predicted vs. Actual Values')
ggplot(testing_dataset, aes(x=predict(model,newdata = testing_dataset), y= testing_dataset$SEED)) +
geom_point() +
geom_abline(intercept=0, slope=1) +
labs(x='Predicted Values', y='Actual Values', title='Predicted vs. Actual Values')
box_2 <- ggplot(cbb_all, aes(x=CONF, y=W)) + geom_boxplot() + theme(axis.text.x=element_text(angle=60,vjust=0.5)) + labs(title="Boxplot of W among Conferences",x= "CONF", y = "W")
box_2
cbb_all_1 <- cbb_all %>%
count(CONF,SEED) %>%
arrange(CONF,SEED) %>%
filter(SEED != "NA")
p_seed <- ggplot(cbb_all_1, aes(CONF, SEED, fill = n)) +
geom_tile(color = "black") +
geom_text(aes(label=n)) +
scale_fill_continuous(low= "floralwhite", high= "darkblue") +
theme(axis.text.x=element_text(angle=45,vjust=0.5)) +
scale_y_continuous(breaks=seq(1,16,1)) +
xlab("Conference")+ylab("Seed")+ggtitle("Total Number of Teams in Seed 1 to Seed 16 For Every Conference Over 2013-2021") + # 2020的数据除外
coord_fixed() +
coord_flip()
p_seed
# 在tile上增加数字
# 改为深色代表“大”，浅色代表“小”,空白代表NA(而并非将NA filter掉)
# 不能忽略ind组的teams，虽然他们的seed都是NA
cbb_all_1 <- cbb_all %>%
count(CONF,SEED) %>%
arrange(CONF,SEED) %>%
filter(SEED != "NA")
p_seed <- ggplot(cbb_all_1, aes(CONF, SEED, fill = n)) +
geom_tile(color = "black") +
geom_text(aes(label=n)) +
scale_fill_continuous(low= "floralwhite", high= "darkblue") +
theme(axis.text.x=element_text(angle=45,vjust=0.5)) +
scale_y_continuous(breaks=seq(1,16,1)) +
xlab("Conference")+ylab("Seed")+ggtitle("Total Number of Teams in Seed 1 to Seed 16 For Every Conference Over 2013-2021") + # 2020的数据除外
coord_fixed() +
coord_flip()
p_seed
# 在tile上增加数字
# 改为深色代表“大”，浅色代表“小”,空白代表NA(而并非将NA filter掉)
# 不能忽略ind组的teams，虽然他们的seed都是NA
cbb_all_1 <- cbb_all %>%
count(CONF,SEED) %>%
arrange(CONF,SEED) %>%
filter(SEED != "NA")
p_seed <- ggplot(cbb_all_1, aes(CONF, SEED, fill = n)) +
geom_tile(color = "black") +
geom_text(aes(label=n)) +
scale_fill_continuous(low= "floralwhite", high= "darkblue") +
theme(axis.text.x=element_text(angle=45,vjust=0.5)) +
scale_y_continuous(breaks=seq(1,16,1)) +
xlab("Conference")+ylab("Seed")+ggtitle("Total Number of Teams in Seed 1 to Seed 16 For Every Conference Over 2013-2021") + # 2020的数据除外
coord_fixed() +
coord_flip()
p_seed
# 在tile上增加数字
# 改为深色代表“大”，浅色代表“小”,空白代表NA(而并非将NA filter掉)
# 不能忽略ind组的teams，虽然他们的seed都是NA
cbb_all_1 <- cbb_all %>%
count(CONF,SEED) %>%
arrange(CONF,SEED) %>%
filter(SEED != "NA")
p_seed <- ggplot(cbb_all_1, aes(CONF, SEED, fill = n)) +
geom_tile(color = "black") +
geom_text(aes(label=n)) +
scale_fill_continuous(low= "floralwhite", high= "darkblue") +
scale_y_continuous(breaks=seq(1,16,1)) +
xlab("Conference")+ylab("Seed")+ggtitle("Total Number of Teams in Seed 1 to Seed 16 For Every Conference Over 2013-2021") + # 2020的数据除外
coord_fixed() +
coord_flip() +
theme_bw()
p_seed
# 在tile上增加数字
# 改为深色代表“大”，浅色代表“小”,空白代表NA(而并非将NA filter掉)
# 不能忽略ind组的teams，虽然他们的seed都是NA
cbb_all_1 <- cbb_all %>%
count(CONF,SEED) %>%
arrange(CONF,SEED) %>%
filter(SEED != "NA")
p_seed <- ggplot(cbb_all_1, aes(CONF, SEED, fill = n)) +
geom_tile(color = "black") +
geom_text(aes(label=n)) +
scale_fill_continuous(low= "floralwhite", high= "darkblue") +
scale_y_continuous(breaks=seq(1,16,1)) +
xlab("Conference")+ylab("Seed")+ggtitle("Total Number of Teams in Seed 1 to Seed 16 For Every Conference Over 2013-2021") + # 2020的数据除外
coord_fixed() +
coord_flip() +
theme_bw()
p_seed
# 在tile上增加数字
# 改为深色代表“大”，浅色代表“小”,空白代表NA(而并非将NA filter掉)
# 不能忽略ind组的teams，虽然他们的seed都是NA
cbb_all_1 <- cbb_all %>%
count(CONF,SEED) %>%
arrange(CONF,SEED) %>%
filter(SEED != "NA")
p_seed <- ggplot(cbb_all_1, aes(CONF, SEED, fill = n)) +
geom_tile(color = "black") +
geom_text(aes(label=n)) +
scale_fill_continuous(low= "floralwhite", high= "darkblue") +
scale_y_continuous(breaks=seq(1,16,1)) +
xlab("Conference")+ylab("Seed")+ggtitle("Total Number of Teams in Seed 1 to Seed 16 For Every Conference Over 2013-2021") + # 2020的数据除外
coord_fixed() +
coord_flip() +
theme_bw()
p_seed
# 在tile上增加数字
# 改为深色代表“大”，浅色代表“小”,空白代表NA(而并非将NA filter掉)
# 不能忽略ind组的teams，虽然他们的seed都是NA
cbb_all_1 <- cbb_all %>%
count(CONF,SEED) %>%
arrange(CONF,SEED) %>%
filter(SEED != "NA")
p_seed <- ggplot(cbb_all_1, aes(CONF, SEED, fill = n)) +
geom_tile(color = "black") +
geom_text(aes(label=n)) +
scale_fill_continuous(low= "floralwhite", high= "darkblue") +
scale_y_continuous(breaks=seq(1,16,1)) +
xlab("Conference")+ylab("Seed")+ggtitle("Total Number of Teams in Seed 1 to Seed 16 For Every Conference Over 2013-2021") + # 2020的数据除外
coord_fixed() +
coord_flip() +
theme_bw()
p_seed
# 在tile上增加数字
# 改为深色代表“大”，浅色代表“小”,空白代表NA(而并非将NA filter掉)
# 不能忽略ind组的teams，虽然他们的seed都是NA
box_4 <- ggplot(cbb_all, aes(x=CONF, y=ADJOE)) +
geom_boxplot() +
theme(axis.text.x=element_text(angle=90,vjust=0.5))+
labs(title="Boxplot of ADJOE among Conferences",x= "CONF", y = "ADJOE")
box_4
grid.arrange(box_2,box_4,box_5,box_6,box_16,box_20,ncol=2,nrow=3)
grid.arrange(box_2,box_4,box_5,box_6,box_16,box_20,ncol=1,nrow=6)
grid.arrange(box_2,box_4,box_5,box_6,box_16,box_20,ncol=2,nrow=3)
grid.arrange(box_2,box_4,box_5,box_6,box_16,box_20,ncol=2,nrow=3)
grid.arrange(box_2,box_4,box_5,box_6,box_16,box_20,ncol=1,nrow=6)
grid.arrange(box_2,box_4,box_5,box_6,box_16,box_20,ncol=3,nrow=2)
grid.arrange(box_2,box_4,box_5,box_6,box_16,box_20,ncol=2,nrow=3)
grid.arrange(box_2,box_4,ncol=2,nrow=1)
grid.arrange(box_2,box_4,ncol=1,nrow=2)
box_4 <- ggplot(cbb_all, aes(x=CONF, y=ADJOE)) +
geom_boxplot() +
theme_bw() +
theme(axis.text.x=element_text(angle=60,vjust=0.5))+
labs(title="Boxplot of ADJOE among Conferences",x= "Conference", y = "ADJOE")
box_4
box_2 <- ggplot(cbb_all, aes(x=CONF, y=W)) +
geom_boxplot() +
theme_bw() +
theme(axis.text.x=element_text(angle=60,vjust=0.5)) +
labs(title="Boxplot of W among Conferences",x= "Conference", y = "W")
box_2
box_2 <- ggplot(cbb_all, aes(x=CONF, y=W)) +
geom_boxplot() +
theme_bw() +
theme(axis.text.x=element_text(angle=60,vjust=0.5)) +
labs(title="Boxplot of W among Conferences",x= "Conference", y = "W")
box_2
box_2 <- ggplot(cbb_all, aes(x=CONF, y=W)) +
geom_boxplot() +
theme_bw() +
theme(axis.text.x=element_text(angle=60,vjust=0.5)) +
labs(title="Boxplot of W among Conferences",x= "Conference", y = "W")
box_2
grid.arrange(box_2,box_4,ncol=1,nrow=2)
grid.arrange(box_2,box_4,ncol=1,nrow=2)
grid.arrange(box_2,box_4,ncol=1,nrow=2)
grid.arrange(box_2,box_4,ncol=1,nrow=2)
grid.arrange(box_2,box_4,ncol=1,nrow=2)
grid.arrange(box_2,box_4,ncol=1,nrow=2)
grid.arrange(box_2,box_4,ncol=1,nrow=2)
grid.arrange(box_2,box_4,ncol=1,nrow=2)
grid.arrange(box_2,box_4,ncol=1,nrow=2)
grid.arrange(box_2,box_4,ncol=1,nrow=2)
grid.arrange(box_2,box_4,ncol=1,nrow=2)
grid.arrange(box_2,box_4,ncol=1,nrow=2)
grid.arrange(box_2,box_4,ncol=1,nrow=2)
grid.arrange(box_2,box_4,ncol=1,nrow=2)
grid.arrange(box_2,box_4,ncol=1,nrow=2)
grid.arrange(box_2,box_4,ncol=1,nrow=2)
grid.arrange(box_5,box_6,ncol=1,nrow=2)
grid.arrange(box_16,box_20,ncol=1,nrow=2)
cbb_all_1 <- cbb_all %>%
count(CONF,SEED) %>%
arrange(CONF,SEED) %>%
filter(SEED != "NA")
p_seed <- ggplot(cbb_all_1, aes(CONF, SEED, fill = n)) +
geom_tile(color = "black") +
geom_text(aes(label=n)) +
scale_fill_continuous(low= "floralwhite", high= "darkblue") +
scale_y_continuous(breaks=seq(1,16,1)) +
xlab("Conference")+ylab("Seed")+ggtitle("Total Number of Teams in Seed 1 to Seed 16 For Every Conference Over 2013-2021") + # 2020的数据除外
coord_fixed() +
coord_flip() +
theme_bw()
p_seed
# 在tile上增加数字
# 改为深色代表“大”，浅色代表“小”,空白代表NA(而并非将NA filter掉)
grid.arrange(box_2,box_4,ncol=1,nrow=2)
grid.arrange(box_5,box_6,ncol=1,nrow=2)
grid.arrange(box_16,box_20,ncol=1,nrow=2)
box_9
box_6 <- ggplot(cbb_all, aes(x=CONF, y=BARTHAG)) +
geom_boxplot() +
theme_bw() +
theme(axis.text.x=element_text(angle=60,vjust=0.5)) +
labs(title="Boxplot of BARTHAG among Conferences",x= "CONF", y = "BARTHAG")
box_6
# 选择
box_5 <- ggplot(cbb_all, aes(x=CONF, y=ADJDE)) +
geom_boxplot() +
theme_bw()
theme(axis.text.x=element_text(angle=60,vjust=0.5))+
labs(title="Boxplot of ADJDE among Conferences",x= "Conference", y = "ADJDE")
box_5
# 选择
box_6 <- ggplot(cbb_all, aes(x=CONF, y=BARTHAG)) +
geom_boxplot() +
theme_bw() +
theme(axis.text.x=element_text(angle=60,vjust=0.5)) +
labs(title="Boxplot of BARTHAG among Conferences",x= "Conference", y = "BARTHAG")
box_6
# 选择
box_10 <- ggplot(cbb_all, aes(x=CONF, y=TORD)) +
geom_boxplot() +
theme_bw() +
theme(axis.text.x=element_text(angle=60,vjust=0.5))+
labs(title="Boxplot of TORD among Conferences",x= "Conference", y = "TORD")
box_10
# 选择
box_10 <- ggplot(cbb_all, aes(x=CONF, y=TORD)) +
geom_boxplot() +
theme_bw() +
theme(axis.text.x=element_text(angle=60,vjust=0.5))+
labs(title="Boxplot of TORD among Conferences",x= "Conference", y = "TORD")
box_10
# 选择
# GWC highest (extreme)
# ind high
box_12 <- ggplot(cbb_all, aes(x=CONF, y=DRB)) +
geom_boxplot() +
theme_bw() +
theme(axis.text.x=element_text(angle=60,vjust=0.5))+
labs(title="Boxplot of DRB among Conferences",x= "Conference", y = "DRB")
box_12
# 选择
box_14 <- ggplot(cbb_all, aes(x=CONF, y=FTRD)) +
geom_boxplot() +
theme_bw() +
theme(axis.text.x=element_text(angle=60,vjust=0.5))+
labs(title="Boxplot of FTRD among Conferences",x= "Conference", y = "FTRD")
box_14
# 选择
box_15 <- ggplot(cbb_all, aes(x=CONF, y=two_P_O)) +
geom_boxplot() +
theme_bw() +
theme(axis.text.x=element_text(angle=60,vjust=0.5))+
labs(title="Boxplot of two_P_O among Conferences",x= "Conference", y = "two_P_O")
box_15
# 选择
# GWC lowest (extreme).
# SWAC, Ind, MEAC low.
# 其他比较平均.
box_16 <- ggplot(cbb_all, aes(x=CONF, y=two_P_D)) +
geom_boxplot() +
theme_bw() +
theme(axis.text.x=element_text(angle=60,vjust=0.5))+
labs(title="Boxplot of two_P_D among Conferences",x= "Conference", y = "two_P_D")
box_16
# 选择
box_16 <- ggplot(cbb_all, aes(x=CONF, y=two_P_D)) +
geom_boxplot() +
theme_bw() +
theme(axis.text.x=element_text(angle=60,vjust=0.5))+
labs(title="Boxplot of two_P_D among Conferences",x= "Conference", y = "two_P_D")
box_16
# 选择
# ASun relatively high
# Amer, SEC, ACC, B10, B12, P12 relatively low
# 其余波动不大
box_17 <- ggplot(cbb_all, aes(x=CONF, y=three_P_O)) + geom_boxplot() + theme(axis.text.x=element_text(angle=45,vjust=0.5))+ labs(title="Boxplot of three_P_O among Conferences",x= "CONF", y = "three_P_O")
box_17
# 平均
box_20 <- ggplot(cbb_all, aes(x=CONF, y=WAB)) +
geom_boxplot() +
theme_bw() +
theme(axis.text.x=element_text(angle=60,vjust=0.5))+
labs(title="Boxplot of WAB among Conferences",x= "Conference", y = "WAB")
box_20
# 选择
# 分布参差不齐
# B12 highest (>0)
# ACC, B10, BE also very high (around 0)
# P12, SEC, A10 high (-5 - 0)
# 其他 (-15 - -5)
grid.arrange(box_2,box_4,ncol=1,nrow=2)
grid.arrange(box_5,box_6,ncol=1,nrow=2)
grid.arrange(box_16,box_20,ncol=1,nrow=2)
# ACC, B10, B12, BE higher
# Ind lower
grid.arrange(box_10,box_12,ncol=1,nrow=2)
grid.arrange(box_14,box_15,ncol=1,nrow=2)
grid.arrange(box_10,box_12,box_14,ncol=1,nrow=3)
grid.arrange(box_15,ncol=1,nrow=1)
grid.arrange(box_10,box_12,ncol=1,nrow=2)
grid.arrange(box_14,box_15,ncol=1,nrow=2)
# 10,12,14 high
# 15 low
# fig.align='center',fig.height=4, fig.width=4
# ggcorrplot(cor(cbb_corr[,"SEED"], cbb_corr),lab = TRUE) + coord_flip()
cbb_corr_df <- as.data.frame(cor(cbb_corr[,"SEED"], cbb_corr))
cbb_corr_df <- cbb_corr_df[,-c(2)]
cbb_corr_df_arg <- cbb_corr_df %>%
gather(`YEAR`,`POSTSEASON`,`G`,`W`,`W_ratio`,`ADJOE`,`ADJDE`,`BARTHAG`,`EFG_O`,`EFG_D`,`TOR`,`TORD`,`ORB`,`DRB`,`FTR`,`FTRD`,`two_P_O`,`two_P_D`,`three_P_O`,`three_P_D`,`ADJ_T`,`WAB`, key = "performance", value = "correlation") %>%
arrange(desc(correlation))
ggplot(cbb_corr_df_arg, aes(performance, correlation)) +
geom_point() +
geom_hline(yintercept= 0.3, color = "pink") +
geom_hline(yintercept= -0.3, color = "pink") +
labs(title="Correlation Coefficients of Seed and other Performance Indicators",x= "Performance Indicators", y = "Correlation Coefficients") +
theme_bw() +
theme(axis.text.x=element_text(angle=60,vjust=0.5))
# 增加y轴的范围，0-1
box_5 <- ggplot(cbb_all, aes(x=CONF, y=ADJDE)) +
geom_boxplot() +
theme_bw() +
theme(axis.text.x=element_text(angle=60,vjust=0.5))+
labs(title="Boxplot of ADJDE among Conferences",x= "Conference", y = "ADJDE")
box_5
# 选择
# B10, B12 lowest..
# ACC, BE, SEC low
box_5
grid.arrange(box_10,box_12,ncol=1,nrow=2)
grid.arrange(box_14,box_15,ncol=1,nrow=2)
# 10,12,14 high
# 15 low
grid.arrange(box_2,box_4,ncol=1,nrow=2) # high
grid.arrange(box_6,box_20,ncol=1,nrow=2) # high
grid.arrange(box_5,box_16,ncol=1,nrow=2) # low
